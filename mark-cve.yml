---
- name: Flag a CVE as a false positive Red Hat Advanced Cluster Security for Kubernetes
  hosts: localhost
  gather_facts: true

  vars_files:
  - vault.yml

  vars:
    acs_host: "{{ vaulted_acs_host }}"
    acs_token: "{{ vaulted_acs_token }}"

  tasks:
    - name: Mark the CVEs as false-positive
      uri:
        url: https://{{ acs_host }}/v1/cve/requests/false-positive
        headers:
          Authorization: "Bearer {{ acs_token }}"
        method: POST
        body: {"cve": "{{ item }}", "scope": {"globalScope": {}},"comment": "Marked false-positive {{ item }}" }
        force_basic_auth: yes
        status_code: 200
        body_format: json
        validate_certs: false
      no_log: false
      changed_when: true
      loop:
        - "CVE-2014-7186"
